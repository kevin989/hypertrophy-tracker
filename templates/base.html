<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title if title else 'Hypertrophy Tracker' }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Utility helpers (on top of Tailwind) */
.card {
  background: #fff;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  border-radius: 1rem; /* 2xl */
  padding: 1.25rem;    /* p-5 */
  border: 1px solid #f1f5f9; /* slate-100 */
}

.btn {
  display:inline-flex; align-items:center; justify-content:center;
  padding:0.5rem 0.875rem; /* px-3.5 py-2 */
  border-radius:0.75rem;   /* xl */
  font-size:0.875rem; font-weight:500;
  color:#fff; background:#4f46e5; /* indigo-600 */
  transition:background-color .2s;
}
.btn:hover { background:#4338ca; } /* indigo-700 */
.btn:active { background:#3730a3; } /* indigo-800 */

.btn-secondary {
  display:inline-flex; align-items:center; justify-content:center;
  padding:0.375rem 0.75rem; /* px-3 py-1.5 */
  border-radius:0.75rem;
  font-size:0.875rem; font-weight:500;
  background:#f1f5f9; color:#334155; /* slate-100 bg + slate-700 text */
  transition:background-color .2s;
}
.btn-secondary:hover { background:#e2e8f0; } /* slate-200 */
.btn-secondary:active { background:#cbd5e1; } /* slate-300 */

.btn-ghost {
  display:inline-flex; align-items:center;
  padding:0.375rem 0.75rem; /* px-3 py-1.5 */
  border-radius:0.75rem;
  font-size:0.875rem;
  color:#cbd5e1; /* slate-300 */
  transition:color .2s, background .2s;
}
.btn-ghost:hover { color:#fff; background:rgba(255,255,255,0.1); }

.input {
  width:100%; border-radius:0.75rem;
  border:1px solid #e2e8f0; /* slate-200 */
  padding:0.5rem 0.75rem; /* px-3 py-2 */
  font-size:0.875rem;
  outline:none;
  transition: box-shadow .2s, border-color .2s;
}
.input:focus {
  border-color:#6366f1; /* indigo-500 */
  box-shadow:0 0 0 2px rgba(99,102,241,0.35);
}

.table {
  width:100%; border-collapse:collapse; font-size:0.875rem;
}
.table th {
  text-align:left; background:#f8fafc; /* slate-50 */
  border-bottom:1px solid #e2e8f0; /* slate-200 */
  padding:0.5rem 0.75rem;
  font-weight:600; color:#334155; /* slate-700 */
}
.table td {
  border-bottom:1px solid #f1f5f9; /* slate-100 */
  padding:0.5rem 0.75rem;
}

.badge {
  display:inline-flex; align-items:center;
  border-radius:9999px;
  background:#f1f5f9; color:#334155; /* slate-100 bg, slate-700 text */
  padding:0.125rem 0.5rem;
  font-size:0.75rem; font-weight:500;
}

.container {
  max-width:72rem; /* 6xl */
  margin-left:auto; margin-right:auto;
  padding-left:1rem; padding-right:1rem;
}

.nav-link {
  color:#cbd5e1; /* slate-300 */
  transition:color .2s;
}
.nav-link:hover { color:#fff; }

.active-link {
  color:#fff; font-weight:600;
}

.nav-btn { display:none; }          /* hidden by default */
@media(min-width:768px){ .nav-btn { display:inline-flex; } }

.mobile-only { display:block; }
@media(min-width:768px){ .mobile-only { display:none; } }

.desktop-only { display:none; }
@media(min-width:768px){ .desktop-only { display:flex; } }

.divider {
  height:1px; background:#e2e8f0; /* slate-200 */
  margin-top:1rem; margin-bottom:1rem;
}

  </style>
</head>

<body class="bg-slate-50 text-slate-800">
  <!-- Sticky top nav -->
  <header class="sticky top-0 z-40 bg-slate-900/95 backdrop-blur supports-[backdrop-filter]:bg-slate-900/75 border-b border-slate-800">
    <div class="container h-14 flex items-center justify-between">
      <!-- Left: Brand -->
      <a href="{{ url_for('dashboard') }}" class="flex items-center gap-2">
        <div class="h-7 w-7 rounded-lg bg-indigo-600 grid place-items-center text-white text-xs font-bold">HT</div>
        <span class="text-white font-semibold">Hypertrophy Tracker</span>
      </a>

      <!-- Right: Primary nav -->
      <nav class="desktop-only items-center gap-2">
        <a class="btn-ghost {{ 'active-link' if request.endpoint=='dashboard' else '' }}" href="{{ url_for('dashboard') }}">Dashboard</a>
        <a class="btn-ghost {{ 'active-link' if request.endpoint=='rm_test' else '' }}" href="{{ url_for('rm_test') }}">RM Test</a>
        <a class="btn-ghost {{ 'active-link' if request.endpoint=='settings' else '' }}" href="{{ url_for('settings') }}">Settings</a>
        <a class="btn-ghost" href="{{ url_for('export_xlsx') }}">Export</a>
        <a class="nav-link" href="{{ url_for('week_view', week=1) }}">Workouts</a>
        <a class="nav-link" href="{{ url_for('history') }}">History</a>


        <!-- Weeks dropdown -->
        <div class="relative">
          <button id="weeksBtn" class="btn-ghost">Weeks ▾</button>
          <div id="weeksMenu" class="hidden absolute right-0 mt-2 w-56 rounded-xl border border-slate-800 bg-slate-900 shadow-lg p-2">
            <div class="grid grid-cols-3 gap-1">
              {% for w in range(1,13) %}
                <a class="text-slate-300 hover:text-white hover:bg-white/10 rounded-lg px-2 py-1 text-sm {{ 'active-link' if request.view_args and request.view_args.get('week')==w else '' }}"
                   href="{{ url_for('week_view', week=w) }}">W{{ w }}</a>
              {% endfor %}
            </div>
          </div>
        </div>

        {% if session.get('authed') %}
          <a class="btn ml-2" href="{{ url_for('logout') }}">Logout</a>
        {% else %}
          <a class="btn ml-2" href="{{ url_for('login') }}">Login</a>
        {% endif %}
      </nav>

      <!-- Mobile menu button -->
      <button id="mobileMenuBtn" class="mobile-only text-slate-300 hover:text-white">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>

    <!-- Mobile menu -->
    <div id="mobileMenu" class="mobile-only hidden border-t border-slate-800">
      <div class="container py-2 grid grid-cols-2 gap-2">
        <a class="btn-secondary" href="{{ url_for('dashboard') }}">Dashboard</a>
        <a class="btn-secondary" href="{{ url_for('rm_test') }}">RM Test</a>
        <a class="btn-secondary" href="{{ url_for('settings') }}">Settings</a>
        <a class="btn-secondary" href="{{ url_for('export_xlsx') }}">Export</a>
        <a class="nav-link" href="{{ url_for('week_view', week=1) }}">Workouts</a>
        <a class="nav-link" href="{{ url_for('history') }}">History</a>
        <div class="col-span-2">
          <div class="font-semibold text-slate-300 mb-1">Weeks</div>
          <div class="grid grid-cols-6 gap-1">
            {% for w in range(1,13) %}
              <a class="btn-secondary text-center" href="{{ url_for('week_view', week=w) }}">W{{ w }}</a>
            {% endfor %}
          </div>
        </div>
        <div class="col-span-2">
          {% if session.get('authed') %}
            <a class="btn w-full" href="{{ url_for('logout') }}">Logout</a>
          {% else %}
            <a class="btn w-full" href="{{ url_for('login') }}">Login</a>
          {% endif %}
        </div>
      </div>
    </div>
  </header>

  <main class="container py-6">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-4 space-y-2">
          {% for category, message in messages %}
            <div class="p-3 rounded-xl
                        {{ 'bg-green-50 text-green-800 border border-green-200' if category=='success'
                           else 'bg-rose-50 text-rose-800 border border-rose-200' }}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>

  <footer class="border-t border-slate-200 py-6 mt-12">
    <div class="container text-xs text-slate-500">
      Built for progressive overload & hypertrophy • {{ request.host }}
    </div>
  </footer>

  <script>
    // Weeks dropdown (desktop)
    const weeksBtn = document.getElementById('weeksBtn');
    const weeksMenu = document.getElementById('weeksMenu');
    if (weeksBtn) {
      weeksBtn.addEventListener('click', () => {
        weeksMenu.classList.toggle('hidden');
      });
      document.addEventListener('click', (e) => {
        if (!weeksBtn.contains(e.target) && !weeksMenu.contains(e.target)) {
          weeksMenu.classList.add('hidden');
        }
      });
    }

    // Mobile menu toggle
    const mobileBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    if (mobileBtn) {
      mobileBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }
  </script>
</body>
</html>
